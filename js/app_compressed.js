class Despesa{constructor(e,t,s,a,o,r){this.ano=e,this.mes=t,this.dia=s,this.tipo=a,this.descricao=o,this.valor=r}validarDados(){for(let e in this)if(!this[e])return!1;return!0}}class BD{constructor(){localStorage.getItem("id")||localStorage.setItem("id",0)}getProximoID(){return Number(localStorage.getItem("id"))+1}gravar(e){let t=this.getProximoID();localStorage.setItem(t,JSON.stringify(e)),localStorage.setItem("id",t)}recuperarTodosRegistros(){let e=[],t=localStorage.getItem("id");for(let s=1;s<=t;s++){let a=JSON.parse(localStorage.getItem(s));a&&(a.id=s,e.push(a))}return e}pesquisar(e){let t=this.recuperarTodosRegistros().filter(t=>(t.ano==e.ano||""==e.ano)&&(t.mes==e.mes||""==e.mes)&&(t.dia==e.dia||""==e.dia)&&(t.tipo==e.tipo||""==e.tipo)&&(t.descricao==e.descricao||""==e.descricao)&&(t.valor==e.valor||""==e.valor));return console.log(e),console.log(t),t}remover(e){localStorage.removeItem(e)}}let bd=new BD;function cadastrarDespesa(){let e=window.document.getElementById("ano"),t=window.document.getElementById("mes"),s=window.document.getElementById("dia"),a=window.document.getElementById("tipo"),o=window.document.getElementById("descricao"),r=window.document.getElementById("valor"),i=new Despesa(e.value,t.value,s.value,a.value,o.value,r.value);i.validarDados()?(bd.gravar(i),e.value="",t.value="",s.value="",a.value="",o.value="",r.value="",criarModal("Registro inserido com sucesso","A despesa foi cadastrada com sucesso","Voltar",!0),console.log("Dados v\xe1lidos"),$("#modalRegistroDespesa").modal("show")):(criarModal("Erro na grava\xe7\xe3o","Existem campos obrigat\xf3rios que n\xe3o foram preenchidos","Voltar e corrigir",!1),console.log("Dados inv\xe1lidos"),$("#modalRegistroDespesa").modal("show"))}function criarModal(e,t,s,a){let o=window.document.querySelector(".modal-header"),r=window.document.querySelector(".modal-header h5"),i=window.document.querySelector(".modal-body"),n=window.document.querySelector("#modalRegistroDespesa .modal-footer .btn");r.innerHTML=e,i.innerHTML=t,n.innerHTML=s,a?(o.classList.remove("text-danger"),o.classList.add("text-success"),n.classList.remove("btn-danger"),n.classList.add("btn-success")):(o.classList.add("text-danger"),o.classList.remove("text-success"),n.classList.add("btn-danger"),n.classList.remove("btn-success"))}function carregaListaDespesas(e=bd.recuperarTodosRegistros()){let t=window.document.getElementById("listaDespesas");t.innerHTML="";let s=0;e.forEach(e=>{console.log(e);let a=t.insertRow();s+=Number(e.valor),a.insertCell(0).innerText=`${e.dia}/${e.mes}/${e.ano}`;let o=window.document.createElement("td");switch(Number(e.tipo)){case 1:o.innerText="Alimenta\xe7\xe3o";break;case 2:o.innerText="Educa\xe7\xe3o";break;case 3:o.innerText="Lazer";break;case 4:o.innerText="Sa\xfade";break;case 5:o.innerText="Transporte"}a.appendChild(o),a.insertCell(2).innerText=e.descricao,a.insertCell(3).innerText=`R$${e.valor}`;let r=window.document.createElement("btn");r.className="btn btn-danger",r.id=`id_despesa_${e.id}`,r.innerHTML='<i class="fas fa-times"> </i>',r.onclick=function e(){bd.remover(this.id.replace("id_despesa_","")),criarModal("Despesa removida","A despesa selecionada foi removida com sucesso","Voltar",!1),$("#modalRegistroDespesa").modal("show"),carregaListaDespesas()},a.insertCell(4).appendChild(r)});let a=t.insertRow(),o=window.document.createElement("th");o.setAttribute("colspan","3"),a.appendChild(o),o.style.textAlign="right",o.innerHTML="Total :",o=window.document.createElement("td"),a.appendChild(o),o.setAttribute("colspan","2"),o.innerHTML=`R$${s}`}function pesquisarDespesas(){console.log("Pesquisou");let e=window.document.getElementById("ano").value,t=window.document.getElementById("mes").value,s=window.document.getElementById("dia").value,a=window.document.getElementById("tipo").value,o=window.document.getElementById("descricao").value,r=window.document.getElementById("valor").value,i=new Despesa(e,t,s,a,o,r);carregaListaDespesas(bd.pesquisar(i))}
